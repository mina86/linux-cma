% Copyright (c) 2012 by Micha≈Ç Nazarewicz <mina86@mina86.com>
% Distributed under the terms of the Creative Commons
% Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0) license.

\subsection{Why physically contiguous memory is needed}

\begin{frame}
  \frametitle{The mighty MMU}

  \begin{columns}[c]

    \column{.6\textwidth}
    \begin{itemize}
    \item Modern CPUs have MMU.
      \begin{itemize}
      \item Virtual $\rightarrow$ physical address.
      \end{itemize}
    \item Virtually contiguous $\notimplies$ physically contiguous.
    \item<1> So why bother?

    \item<2> MMU stands behind CPU.
    \item<2> There are other chips in the system.
    \item<2> Some require large buffers.
      \begin{itemize}
      \item<2> 5-megapixel camera anyone?
      \end{itemize}
    \item<2> On embedded, there's plenty of those.
    \end{itemize}

    \column{.4\textwidth}
    \begin{center}
      \includegraphics<1>[width=\textwidth]{build/mmu-iommu-images--img-mmu.eps}
      \includegraphics<2>[width=\textwidth]{build/mmu-iommu-images--img-nommu.eps}
    \end{center}

  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{The mighty DMA}

  \begin{columns}[c]

    \column{.6\textwidth}
    \begin{itemize}
    \item DMA can do vectored I/O.
    \item Gathering buffer from scattered parts.
      \begin{itemize}
        \item {\footnotesize Hence also another name: DMA scatter-gather.}
      \end{itemize}
    \item Contiguous for the device $\notimplies$ physically contiguous.
    \item<1> So why bother?
    \item<2> DMA may lack vectored I/O~support.
    \item<2> DMA can do linear access only.
    \end{itemize}

    \column{.4\textwidth}
    \begin{center}
      \includegraphics[width=\textwidth]{build/mmu-iommu-images--img-dma.eps}
    \end{center}

  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{The mighty I/O~MMU}

  \begin{columns}[c]

    \column{.6\textwidth}
    \begin{itemize}
    \item What about an I/O~MMU?
      \begin{itemize}
      \item Device $\rightarrow$ physical address.
      \end{itemize}
    \item Same deal as with CPU's MMU.
    \item<1> So why bother?
    \item<2> I/O~MMU is not so common.
    \item<2> I/O~MMU takes time.
    \item<2> I/O~MMU takes power.
    \end{itemize}

    \column{.4\textwidth}
    \begin{center}
      \includegraphics[width=\textwidth]{build/mmu-iommu-images--img-iommu.eps}
    \end{center}

  \end{columns}
\end{frame}
